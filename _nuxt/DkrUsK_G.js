import{g as Y,r as u,A as U,c as a,a as e,y as h,d as x,t as n,b as c,m as M,p as r,v as V,F as j,B as R,W as Z,l as B,C as K,V as ee,o as l,n as S,s as N,_ as te}from"./W0gg2iT2.js";import{S as se}from"./DP6LML0j.js";import{X as z}from"./hq94hZ8v.js";import{c as D}from"./Dn-7A9HV.js";import{I as L}from"./tbX-b2re.js";import{C as le}from"./C6TyFrC2.js";import{T as $}from"./B3yYYe44.js";const ae=D("badge-check",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const oe=D("file-badge",[["path",{d:"M13 22h5a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v3.3",key:"cvl1xm"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m7.69 16.479 1.29 4.88a.5.5 0 0 1-.698.591l-1.843-.849a1 1 0 0 0-.879.001l-1.846.85a.5.5 0 0 1-.692-.593l1.29-4.88",key:"1ff7gj"}],["circle",{cx:"6",cy:"14",r:"3",key:"a1xfv6"}]]);const ie=D("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),ne={class:"min-h-screen bg-slate-50 pb-[calc(1.5rem+env(safe-area-inset-bottom))] pt-[env(safe-area-inset-top)]"},de={class:"bg-slate-50/90 backdrop-blur"},re={class:"flex items-center justify-between px-4 pt-3 pb-2"},ue={class:"rounded-2xl bg-white px-3 py-2 shadow-sm"},ce={class:"text-xs font-medium text-slate-500"},pe={class:"text-emerald-600"},fe={class:"text-slate-900"},xe={class:"px-4 pb-3 space-y-3"},me={class:"flex items-center gap-2 rounded-2xl bg-white px-3 py-2.5 shadow-sm"},ve={class:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},be={class:"inline-flex w-full gap-1 rounded-full bg-white p-1 shadow-sm overflow-x-auto no-scrollbar"},ge=["onClick"],he={class:"flex items-center gap-2"},ye=["value"],we={class:"mt-1 space-y-4 px-4"},_e={class:"py-3.5"},ke={class:"mb-3 flex items-center justify-between"},Ce={class:"inline-flex items-center gap-2"},Ue={class:"text-xs text-slate-400"},je={key:0,class:"space-y-2.5"},Se=["onClick"],Ae={class:"flex flex-1 items-start gap-3"},Fe={class:"space-y-1"},Te={class:"text-[13px] font-semibold text-gray-900 leading-snug"},Ie={class:"inline-flex flex-wrap items-center gap-1.5"},Me={class:"px-2.5 py-[2px] text-[11px] font-medium text-sky-600"},Re={key:0,class:"text-[11px] text-slate-400"},ze={class:"flex flex-col items-end gap-1"},Le={key:1,class:"mt-4 text-center text-sm text-slate-400"},$e={class:"relative w-full sm:max-w-sm max-h-[90vh] rounded-t-3xl bg-white p-4 pb-[calc(1.25rem+env(safe-area-inset-bottom))] shadow-lg sm:rounded-2xl flex flex-col"},De={class:"mb-3 flex items-center justify-between"},Ve={class:"flex items-center gap-2"},Be={class:"flex h-9 w-9 items-center justify-center rounded-full bg-indigo-50"},Ne={class:"text-sm font-semibold text-slate-900 line-clamp-2"},Oe={class:"text-xs text-slate-500"},Pe={class:"space-y-3 flex-1 overflow-y-auto pr-1"},Ee={key:0,class:"space-y-2"},He={key:0,class:"overflow-hidden rounded-2xl border border-slate-200 bg-slate-50"},qe=["src"],Ge={key:1,class:"overflow-hidden rounded-2xl border border-slate-200 bg-slate-50 h-[320px]"},We=["src"],Je={key:2,class:"text-xs text-slate-500"},Qe={class:"mt-1 rounded-2xl bg-amber-50 px-3 py-2 text-xs text-amber-700"},Xe={class:"flex items-start gap-2"},Ye={key:1,class:"space-y-3"},Ze={key:0,class:"relative overflow-hidden rounded-2xl border border-indigo-200 bg-slate-50"},Ke=["src"],et={key:1,class:"h-[260px] w-full bg-slate-900/5"},tt=["src"],st={key:1,class:"mt-1 flex cursor-pointer items-center justify-center gap-2 rounded-2xl border border-dashed border-slate-300 bg-slate-50 px-3 py-4 text-sm text-slate-700 hover:border-indigo-400 hover:bg-indigo-50/40"},lt={class:"space-y-1"},at={class:"rounded-2xl bg-amber-50 px-3 py-2 text-xs text-amber-700"},ot={class:"flex items-start gap-2"},it={class:"mt-4 flex gap-2"},nt=["disabled"],dt={class:"relative w-[92%] max-w-xs rounded-2xl bg-white px-4 py-4 text-center shadow-lg"},rt={key:0,class:"absolute inset-0 z-10 flex flex-col items-center justify-center rounded-2xl bg-white/90"},ut={class:"progress-ring__label"},ct={class:"mx-auto mb-3 flex h-11 w-11 items-center justify-center rounded-full bg-amber-50"},pt={class:"mb-2 text-xs text-slate-600"},ft={key:0,class:"font-medium"},xt={class:"mb-4 text-xs leading-relaxed text-slate-600"},mt={class:"font-medium"},vt={class:"flex gap-2"},bt=["disabled"],gt=["disabled"],ht=Y({__name:"certificates",setup(yt){ee();const m=u([{id:"CRS-001",code:"SAF-101",name:"หลักสูตรความปลอดภัยในการทำงานในอาคารสูง",type:"อบรมภายใน",certificateUrl:"https://images.pexels.com/photos/105028/pexels-photo-105028.jpeg",certificateFileType:"image",uploadedAt:"2025-11-10T09:30:00+07:00",trainingCompletedAt:"2025-10-20T00:00:00+07:00"},{id:"CRS-002",code:"ELEC-201",name:"การใช้งานและบำรุงรักษาระบบไฟฟ้าเบื้องต้น",type:"อบรมภายนอก"},{id:"CRS-003",code:"AIR-305",name:"การซ่อมและบำรุงรักษาเครื่องปรับอากาศ",type:"อบรมภายนอก"},{id:"CRS-004",code:"LIFT-110",name:"การตรวจสอบและใช้งานลิฟต์โดยสารอย่างปลอดภัย",type:"อบรมภายใน"},{id:"CRS-005",code:"CERT-001",name:"ใบอนุญาตช่างไฟฟ้าภายในอาคาร",type:"ใบอนุญาตวิชาชีพ"}]),O=["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],A=o=>{if(!o)return"";const t=new Date(o);if(Number.isNaN(t.getTime()))return"";const s=t.getDate().toString().padStart(2,"0"),y=O[t.getMonth()],I=t.getFullYear()+543;return`${s} ${y} ${I}`},w=u(""),k=u("all"),C=u("all"),P=[{value:"all",label:"ทั้งหมด"},{value:"uploaded",label:"อัปแล้ว"},{value:"pending",label:"ยังไม่อัป"}],E=["อบรมภายใน","อบรมภายนอก","ใบอนุญาตวิชาชีพ"],F=U(()=>m.value.filter(o=>{const t=w.value.trim().toLowerCase();if(t&&!`${o.name} ${o.code}`.toLowerCase().includes(t)||C.value!=="all"&&o.type!==C.value)return!1;const s=!!o.certificateUrl;return!(k.value==="uploaded"&&!s||k.value==="pending"&&s)})),H=U(()=>m.value.length),q=U(()=>m.value.filter(o=>!!o.certificateUrl).length);U(()=>m.value.filter(o=>!o.certificateUrl).length);const T=u(!1),i=u(null),d=u(null),b=u(null),g=u(!1),p=u(!1),v=u(0),f=u(""),G=o=>{i.value=o,d.value=null,g.value=!1,p.value=!1,v.value=0,f.value="",T.value=!0},_=()=>{T.value=!1,d.value=null,g.value=!1,p.value=!1,v.value=0,f.value="",b.value&&(b.value.value="")},W=o=>{const s=o.target.files?.[0];if(!s)return;const y=URL.createObjectURL(s),I=s.type==="application/pdf"||s.name.toLowerCase().endsWith(".pdf");d.value={url:y,type:I?"pdf":"image",name:s.name,file:s}},J=()=>{p.value||(d.value=null,b.value&&(b.value.value=""))},Q=()=>{!d.value||!i.value||!f.value||(v.value=0,g.value=!0)},X=async()=>{if(!(!i.value||!d.value||p.value)){p.value=!0,v.value=0;try{for(let t=10;t<=100;t+=10)await new Promise(s=>setTimeout(s,120)),v.value=t;const o=m.value.findIndex(t=>t.id===i.value?.id);if(o!==-1){const t=new Date(f.value+"T00:00:00").toISOString(),s=new Date().toISOString();m.value[o]={...m.value[o],certificateUrl:d.value.url,certificateFileType:d.value.type,uploadedAt:s,trainingCompletedAt:t},i.value=m.value[o]}g.value=!1,_()}catch(o){console.error("saveCertificate error:",o)}finally{p.value=!1,v.value=0,d.value=null,b.value&&(b.value.value="")}}};return(o,t)=>(l(),a("div",ne,[e("header",de,[e("div",re,[t[8]||(t[8]=e("div",{class:"flex items-center gap-3"},[e("div",null,[e("p",{class:"text-base font-semibold text-slate-900"}," ประกาศนียบัตรพนักงาน "),e("p",{class:"text-xs text-slate-500"}," อัปโหลดประกาศนียบัตร/ใบรับรองการอบรม ")])],-1)),e("div",ue,[e("p",ce,[t[6]||(t[6]=x(" อัปแล้ว ",-1)),e("span",pe,n(q.value),1),t[7]||(t[7]=x(" / ทั้งหมด ",-1)),e("span",fe,n(H.value),1)])])]),e("div",xe,[e("div",me,[c(r(se),{class:"h-5 w-5 text-slate-400"}),M(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>w.value=s),type:"text",class:"w-full border-none bg-transparent text-[14px] text-slate-900 placeholder:text-slate-400 focus:outline-none",placeholder:"ค้นหารายวิชา / ชื่อประกาศนียบัตร..."},null,512),[[V,w.value]]),w.value?(l(),a("button",{key:0,type:"button",class:"flex h-7 w-7 items-center justify-center rounded-full bg-slate-100 text-slate-400",onClick:t[1]||(t[1]=s=>w.value="")},[c(r(z),{class:"h-4 w-4"})])):h("",!0)]),e("div",ve,[e("div",be,[(l(),a(j,null,R(P,s=>e("button",{key:s.value,type:"button",class:S(["shrink-0 rounded-full px-3 py-1.5 text-xs font-medium whitespace-nowrap",k.value===s.value?"bg-indigo-600 text-white shadow-sm":"text-slate-600"]),onClick:y=>k.value=s.value},n(s.label),11,ge)),64))]),e("div",he,[c(r(ie),{class:"h-4 w-4 text-slate-400"}),M(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>C.value=s),class:"w-full sm:w-auto min-h-[38px] rounded-full border border-slate-200 bg-white px-3 py-2 text-xs text-slate-700 focus:border-indigo-400 focus:outline-none"},[t[9]||(t[9]=e("option",{value:"all"},"ทุกประเภท",-1)),(l(),a(j,null,R(E,s=>e("option",{key:s,value:s},n(s),9,ye)),64))],512),[[Z,C.value]])])])])]),e("main",we,[e("section",_e,[e("div",ke,[e("div",Ce,[c(r(oe),{class:"h-5 w-5 text-indigo-500"}),t[10]||(t[10]=e("p",{class:"text-sm font-semibold text-slate-900"}," รายวิชา / หลักสูตรที่อบรม ",-1))]),e("p",Ue,n(F.value.length)+" รายการ ",1)]),F.value.length?(l(),a("div",je,[(l(!0),a(j,null,R(F.value,s=>(l(),a("button",{key:s.id,type:"button",class:"flex w-full items-center justify-between gap-3 rounded-2xl border border-slate-100 bg-white px-3 py-3 text-left shadow-sm active:scale-[0.99] active:bg-slate-50",onClick:y=>G(s)},[e("div",Ae,[e("div",{class:S(["mt-0.5 flex h-10 w-10 items-center justify-center rounded-full",s.certificateUrl?"bg-emerald-50":"bg-slate-100"])},[s.certificateUrl?(l(),N(r(ae),{key:0,class:"h-5 w-5 text-emerald-500"})):(l(),N(r(L),{key:1,class:"h-5 w-5 text-slate-400"}))],2),e("div",Fe,[e("p",Te,n(s.name),1),e("div",Ie,[e("span",Me,n(s.type),1),e("span",{class:S(["rounded-full px-2.5 py-[2px] text-[11px] font-semibold",s.certificateUrl?"bg-emerald-500 text-white":"bg-rose-500 text-white"])},n(s.certificateUrl?"อัปโหลดแล้ว":"ยังไม่อัปโหลด"),3)]),s.certificateUrl&&s.trainingCompletedAt?(l(),a("p",Re," อบรมสำเร็จเมื่อ "+n(A(s.trainingCompletedAt)),1)):h("",!0)])]),e("div",ze,[e("span",{class:S(["text-[11px] font-semibold",s.certificateUrl?"text-emerald-600":"text-indigo-600"])},n(s.certificateUrl?"ดูประกาศนียบัตร":"อัปโหลด"),3),c(r(le),{class:"h-4 w-4 text-slate-400"})])],8,Se))),128))])):(l(),a("p",Le," ไม่พบรายการตามเงื่อนไขที่เลือก "))])]),T.value&&i.value?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-end justify-center bg-black/50 sm:items-center",onClick:B(_,["self"])},[e("div",$e,[t[18]||(t[18]=e("div",{class:"mx-auto mb-2 h-1.5 w-12 rounded-full bg-slate-200 sm:hidden"},null,-1)),e("div",De,[e("div",Ve,[e("div",Be,[c(r(L),{class:"h-5 w-5 text-indigo-600"})]),e("div",null,[e("p",Ne,n(i.value.name),1),e("p",Oe,n(i.value.type),1)])]),e("button",{type:"button",class:"flex h-9 w-9 items-center justify-center rounded-full bg-slate-100 text-slate-500",onClick:_},[c(r(z),{class:"h-5 w-5"})])]),e("div",Pe,[i.value.certificateUrl?(l(),a("div",Ee,[t[12]||(t[12]=e("p",{class:"text-sm font-semibold text-slate-800"}," ประกาศนียบัตรที่อัปโหลดแล้ว ",-1)),i.value.certificateFileType!=="pdf"?(l(),a("div",He,[e("img",{src:i.value.certificateUrl,alt:"certificate preview",loading:"lazy",class:"max-h-[320px] w-full object-contain bg-slate-900/5"},null,8,qe)])):(l(),a("div",Ge,[e("iframe",{src:i.value.certificateUrl,loading:"lazy",class:"h-full w-full"},null,8,We)])),i.value.trainingCompletedAt?(l(),a("p",Je," อบรมสำเร็จเมื่อ "+n(A(i.value.trainingCompletedAt)),1)):h("",!0),e("div",Qe,[e("div",Xe,[c(r($),{class:"h-4 w-4 mt-[1px]"}),t[11]||(t[11]=e("p",null,[x(" ประกาศนียบัตรสำหรับรายวิชานี้ถูกอัปโหลดแล้ว "),e("span",{class:"font-semibold"},"ไม่สามารถแก้ไขหรือเปลี่ยนไฟล์ได้"),x(" หากมีข้อผิดพลาด กรุณาติดต่อเจ้าหน้าที่ HR ")],-1))])])])):(l(),a("div",Ye,[t[17]||(t[17]=e("p",{class:"text-sm font-semibold text-slate-800"}," อัปโหลดประกาศนียบัตร ",-1)),d.value?(l(),a("div",Ze,[d.value.type==="image"?(l(),a("img",{key:0,src:d.value.url,alt:"certificate preview",class:"max-h-[260px] w-full object-contain bg-slate-900/5"},null,8,Ke)):(l(),a("div",et,[e("iframe",{src:d.value.url,class:"h-full w-full"},null,8,tt)])),e("button",{type:"button",class:"absolute right-2 top-2 flex h-9 w-9 items-center justify-center rounded-full bg-rose-500 text-white shadow-md active:scale-95",onClick:J},[c(r(z),{class:"h-5 w-5"})])])):(l(),a("label",st,[c(r(L),{class:"h-5 w-5 text-indigo-500"}),t[13]||(t[13]=e("div",{class:"text-left"},[e("p",{class:"font-semibold"},"เลือกไฟล์จากเครื่อง"),e("p",{class:"text-xs text-slate-400"}," รองรับ .JPG / .PNG / .PDF ขนาดไม่เกิน 5 MB ")],-1)),e("input",{ref_key:"fileInput",ref:b,type:"file",accept:"image/*,.pdf",class:"hidden",onChange:W},null,544)])),e("div",lt,[t[14]||(t[14]=e("p",{class:"text-sm font-semibold text-slate-800"}," วันที่อบรมสำเร็จ ",-1)),M(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=s=>f.value=s),class:"mt-1 w-full min-h-[42px] rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-[14px] text-slate-900 focus:border-indigo-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-100"},null,512),[[V,f.value]]),t[15]||(t[15]=e("p",{class:"text-xs text-slate-400"}," เลือกวันที่ที่ท่านอบรมสำเร็จจริง เพื่อใช้บันทึกในระบบ ",-1))]),e("div",at,[e("div",ot,[c(r($),{class:"h-4 w-4 mt-[1px]"}),t[16]||(t[16]=e("p",null,[x(" ระบบอนุญาตให้อัปโหลดประกาศนียบัตร "),e("span",{class:"font-semibold"},"ได้เพียงครั้งเดียว"),x(" เมื่อบันทึกแล้วจะไม่สามารถเปลี่ยนไฟล์ได้ ")],-1))])])]))]),e("div",it,[i.value.certificateUrl?(l(),a("button",{key:0,type:"button",class:"w-full min-h-[44px] rounded-full bg-emerald-500 px-3 py-2 text-sm font-semibold text-white shadow-sm active:scale-95",onClick:_}," ปิด ")):(l(),a(j,{key:1},[e("button",{type:"button",class:"flex-1 min-h-[44px] rounded-full border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-600",onClick:_}," ยกเลิก "),e("button",{type:"button",class:"flex-1 min-h-[44px] rounded-full bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm disabled:bg-slate-300 disabled:cursor-not-allowed",disabled:!d.value||!f.value,onClick:Q}," บันทึกประกาศนียบัตร ",8,nt)],64))])])])):h("",!0),g.value?(l(),a("div",{key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:t[5]||(t[5]=B(s=>!p.value&&(g.value=!1),["self"]))},[e("div",dt,[p.value?(l(),a("div",rt,[e("div",{class:"progress-ring",style:K({"--value":v.value+"%"})},[e("span",ut,n(v.value)+"%",1)],4),t[19]||(t[19]=e("p",{class:"mt-2 text-xs text-slate-600"}," กำลังอัปโหลดประกาศนียบัตร... ",-1))])):h("",!0),e("div",ct,[c(r($),{class:"h-6 w-6 text-amber-600"})]),t[25]||(t[25]=e("p",{class:"mb-1 text-base font-semibold text-slate-900"}," ยืนยันการอัปโหลดประกาศนียบัตร ",-1)),e("p",pt,[t[20]||(t[20]=x(" หลักสูตร: ",-1)),i.value?(l(),a("span",ft,n(i.value.name),1)):h("",!0)]),e("p",xt,[t[21]||(t[21]=x(" วันที่อบรมสำเร็จ: ",-1)),e("span",mt,n(f.value?A(f.value+"T00:00:00"):"-"),1),t[22]||(t[22]=e("br",null,null,-1)),t[23]||(t[23]=x(" เมื่อยืนยันแล้ว ระบบจะบันทึกประกาศนียบัตรสำหรับรายวิชานี้ ",-1)),t[24]||(t[24]=e("span",{class:"font-semibold"}," และจะไม่สามารถแก้ไข / เปลี่ยนไฟล์ได้ในภายหลัง ",-1))]),e("div",vt,[e("button",{type:"button",class:"flex-1 min-h-[44px] rounded-full border border-slate-200 bg-white px-3 py-2 text-sm font-semibold text-slate-600 disabled:opacity-40 disabled:cursor-not-allowed",disabled:p.value,onClick:t[4]||(t[4]=s=>g.value=!1)}," ยกเลิก ",8,bt),e("button",{type:"button",class:"flex-1 min-h-[44px] rounded-full bg-emerald-500 px-3 py-2 text-sm font-semibold text-white shadow-sm active:scale-95 disabled:bg-slate-300 disabled:cursor-not-allowed",disabled:p.value,onClick:X},n(p.value?"กำลังอัปโหลด...":"ยืนยันอัปโหลด"),9,gt)])])])):h("",!0)]))}}),At=te(ht,[["__scopeId","data-v-cd6d1ce5"]]);export{At as default};
