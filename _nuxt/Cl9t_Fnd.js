import{C as z,M as E,f as ee,c as te,d as se,b as ae,S as ne,u as le}from"./uqwrqM6q.js";import{C as V}from"./D0YaOiqp.js";import{g as R,A as h,c as o,a as e,b as u,p as s,t as p,n as y,s as I,o as l,F as H,B as K,r as S,E as J,P as ie,l as oe,w as N,y as C,d as j,_ as re,Q as de,G as ce,H as ue,z as Q,k as me}from"./W0gg2iT2.js";import{I as pe}from"./tbX-b2re.js";import{_ as O,D as xe,S as fe}from"./AREj3VB0.js";import{X as U}from"./hq94hZ8v.js";import{c as q}from"./Dn-7A9HV.js";import{C as ge}from"./jDUQwMCP.js";import{F as be}from"./MggqGaWE.js";import{U as he}from"./CrJtTzIZ.js";import{A as ve}from"./CFEcHXgB.js";const we=q("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const ye=q("clock-3",[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const ke=q("octagon-alert",[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]]),Se={class:"px-4 pb-3"},$e={class:"rounded-2xl bg-white px-3 py-2.5 shadow-sm"},Ce={class:"mb-1 flex items-center justify-between text-xs text-slate-500"},Te={class:"inline-flex items-center gap-1.5"},Me={class:"text-sm font-semibold text-slate-900 leading-snug"},je={class:"mt-2 flex items-center justify-between"},Re={class:"inline-flex items-center gap-1.5 text-[13px] text-slate-600"},_e=R({__name:"TaskDetailHeader",props:{task:{}},setup(t){const n=t,a=h(()=>ee(n.task.updatedAt)),m=b=>{switch(b){case"in_progress":return"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£";case"done":return"‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß"}};return(b,k)=>(l(),o("div",Se,[e("div",$e,[e("div",Ce,[e("div",Te,[u(s(z),{class:"h-3.5 w-3.5 text-slate-400"}),e("span",null,p(s(a)),1)])]),e("p",Me,p(t.task.description),1),e("div",je,[e("div",Re,[u(s(E),{class:"h-3.5 w-3.5 text-sky-500"}),e("span",null,"‡∏´‡πâ‡∏≠‡∏á "+p(t.task.room),1)]),e("span",{class:y(["inline-flex items-center gap-1.5 rounded-full px-2 py-0.5 text-xs font-medium",t.task.status==="in_progress"?"bg-amber-50 text-amber-700":"bg-emerald-50 text-emerald-700"])},[t.task.status==="in_progress"?(l(),I(s(z),{key:0,class:"h-3 w-3"})):(l(),I(s(V),{key:1,class:"h-3 w-3"})),e("span",null,p(m(t.task.status)),1)],2)])])]))}}),Ae={class:"rounded-2xl bg-white p-3.5 shadow-sm"},Le={class:"mb-2 flex items-center justify-between"},Ie={class:"inline-flex items-center gap-2 text-sm font-semibold text-slate-900"},Be={class:"text-xs text-slate-400"},De={class:"flex gap-2 overflow-x-auto pb-1"},Fe=["onClick"],Pe=["src","alt"],ze=["src"],Ee={class:"absolute bottom-1 right-1 rounded-full bg-black/60 px-1.5 py-0.5 text-[11px] font-medium text-white"},Ne=R({__name:"TaskMedia",props:{media:{}},emits:["preview"],setup(t){return(n,a)=>(l(),o("section",Ae,[e("div",Le,[e("div",Ie,[u(s(pe),{class:"h-4 w-4 text-sky-500"}),a[1]||(a[1]=e("span",null,"‡∏™‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô",-1))]),e("span",Be,p(t.media.length)+" ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ",1)]),e("div",De,[(l(!0),o(H,null,K(t.media,(m,b)=>(l(),o("button",{key:b,type:"button",class:"relative h-32 min-w-[140px] overflow-hidden rounded-2xl bg-slate-100 focus:outline-none",onClick:k=>n.$emit("preview",m)},[m.type==="image"?(l(),o("img",{key:0,src:m.url,alt:`‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô ${b+1}`,class:"h-full w-full cursor-zoom-in object-cover",onError:a[0]||(a[0]=k=>k.target.src="/images/no_Img.png")},null,40,Pe)):(l(),o("video",{key:1,src:m.url,class:"h-full w-full object-cover",muted:"",playsinline:""},null,8,ze)),e("span",Ee,p(m.type==="image"?"‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û":"‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠"),1)],8,Fe))),128))])]))}}),Oe={class:"mt-2 flex items-center justify-between"},Ue={class:"relative w-full rounded-t-3xl bg-white p-5 pb-5 shadow-lg"},Ve={class:"h-[70vh] w-full max-w-md rounded-t-3xl bg-white shadow-lg sm:h-[70vh] sm:rounded-2xl"},He={class:"flex items-center justify-between px-4 pt-3 pb-2"},qe={class:"flex items-center gap-2"},Ge={class:"flex h-8 w-8 items-center justify-center rounded-full bg-emerald-50"},Je={class:"text-[11px] text-slate-500"},Qe={class:"h-[calc(100%-49px)] w-full"},Ke=R({__name:"ServiceMap",setup(t){const n=S({lat:13.7563,lng:100.5018,updatedAt:new Date().toISOString()}),a=S(!1),m=g=>new Date(g).toLocaleString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),b=h(()=>`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ${m(n.value.updatedAt)}`),k=S(null),r=S(null),v=S(null);let d=null;const i=()=>{a.value=!0},f=()=>{a.value=!1,v.value&&(v.value.setMap(null),v.value=null),r.value&&(r.value=null)},B=()=>{if(typeof window>"u")return Promise.resolve();const g=window.google;return g&&g.maps?Promise.resolve():(d||(d=new Promise((c,$)=>{const M=document.createElement("script");M.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAgf48aWg9fr48mzGvoJqKSsNINYzBhdRQ&language=th&region=TH",M.async=!0,M.defer=!0,M.onload=()=>c(),M.onerror=()=>$(new Error("Google Maps JavaScript API failed to load")),document.head.appendChild(M)})),d)},T=async()=>{if(!k.value)return;await B();const g=window.google;if(!g||!g.maps)return;const{lat:c,lng:$}=n.value;r.value?(r.value.setCenter({lat:c,lng:$}),v.value&&v.value.setPosition({lat:c,lng:$})):(r.value=new g.maps.Map(k.value,{center:{lat:c,lng:$},zoom:13,disableDefaultUI:!0,zoomControl:!0,mapTypeControl:!1,fullscreenControl:!1,streetViewControl:!1,gestureHandling:"greedy"}),v.value=new g.maps.Marker({position:{lat:c,lng:$},map:r.value,title:"‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ä‡πà‡∏≤‡∏á"}))};return J(a,async g=>{g&&(await ie(),await T())}),J(n,g=>{if(!r.value||!v.value||!g)return;const c={lat:g.lat,lng:g.lng};v.value.setPosition(c),r.value.setCenter(c)},{deep:!0}),(g,c)=>(l(),o(H,null,[e("div",Oe,[c[1]||(c[1]=e("p",{class:"text-[11px] text-slate-500"},"‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á‡∏ö‡∏ô‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà",-1)),e("button",{type:"button",class:"inline-flex items-center gap-1 rounded-full bg-emerald-500 px-2.5 py-1 text-[11px] font-medium text-white shadow-sm active:scale-95",onClick:oe(i,["stop"])},[u(s(E),{class:"h-3.5 w-3.5 text-white"}),c[0]||(c[0]=e("span",null,"‡∏î‡∏π‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á",-1))])]),u(O,{"model-value":a.value,"onUpdate:modelValue":f},{default:N(()=>[e("div",Ue,[e("div",Ve,[e("div",He,[e("div",qe,[e("div",Ge,[u(s(E),{class:"h-4 w-4 text-emerald-600"})]),e("div",null,[c[2]||(c[2]=e("p",{class:"text-sm font-semibold text-slate-900"}," ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ä‡πà‡∏≤‡∏á (‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå) ",-1)),e("p",Je,p(b.value),1)])]),e("button",{type:"button",class:"flex h-8 w-8 items-center justify-center rounded-full bg-slate-100 text-slate-500",onClick:f},[u(s(U),{class:"h-4 w-4"})])]),c[3]||(c[3]=e("div",{class:"h-[1px] bg-slate-100"},null,-1)),e("div",Qe,[e("div",{ref_key:"mapContainer",ref:k,class:"h-full w-full"},null,512)])])])]),_:1},8,["model-value"])],64))}}),We={class:"rounded-2xl bg-white p-3.5 shadow-sm"},Xe={class:"mb-3 flex items-center justify-between"},Ye={class:"inline-flex items-center gap-2 text-sm font-semibold text-slate-900"},Ze={class:"text-xs text-slate-400"},et={class:"relative"},tt=["src","alt"],st={key:0,class:"absolute -bottom-0.5 -right-0.5 flex h-3.5 w-3.5 items-center justify-center rounded-full bg-emerald-500 shadow-sm"},at={key:0,class:"mb-0.5 text-xs font-medium uppercase tracking-[0.18em] text-indigo-500"},nt={class:"text-sm font-semibold text-slate-900"},lt={key:1,class:"mt-0.5 text-xs leading-snug text-slate-500 whitespace-pre-line"},it=R({__name:"TaskTimeLine",props:{status:{},currentStep:{},timeline:{}},setup(t){const n=t,a={1:{key:"received",icon:"https://img.icons8.com/color/48/inbox.png"},2:{key:"prepare",icon:"https://img.icons8.com/color/48/maintenance.png"},3:{key:"on_the_way",icon:"https://img.icons8.com/color/48/road.png"},4:{key:"fixing",icon:"https://img.icons8.com/color/48/service.png"},5:{key:"done",icon:"https://img.icons8.com/color/48/checkmark--v1.png"}},m=h(()=>(n.timeline??[]).map(d=>{const i=a[d.step]??{key:`step_${d.step}`,icon:"https://img.icons8.com/color/48/info.png"};return{step:d.step,key:i.key,label:d.label||`‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà ${d.step}`,icon:i.icon,runtime:d}})),b=d=>d<n.currentStep||n.status==="done"?"border-emerald-500 bg-emerald-50":d===n.currentStep?"bg-indigo-50 border border-indigo-200 shadow-sm":"border-slate-200 bg-slate-50 opacity-80",k=d=>d<n.currentStep||n.status==="done"?"bg-emerald-50 border border-emerald-100":d===n.currentStep?"bg-indigo-50 border border-indigo-100":"bg-slate-50 border border-slate-100 opacity-90",r=h(()=>{const d=new Map;return(n.timeline??[]).forEach(i=>{d.set(i.step,i)}),d}),v=d=>{const i=r.value.get(d);if(!i)return"";if(i.note)return i.note;if(i.finishedAt){const f=i.operator?`
‡∏ú‡∏π‡πâ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô ${i.operator}`:"";return`‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏£‡πá‡∏à ${te(i.finishedAt)}${f}`}return i.dueAt?`‡∏ß‡∏±‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏£‡πá‡∏à ${se(i.dueAt)}`:""};return(d,i)=>(l(),o("section",We,[e("div",Xe,[e("div",Ye,[u(s(z),{class:"h-4 w-4 text-emerald-600"}),i[0]||(i[0]=e("span",null,"‡πÑ‡∏ó‡∏°‡πå‡πÑ‡∏•‡∏ô‡πå‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£",-1))]),e("span",Ze," ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà "+p(t.currentStep)+" / 5 ",1)]),e("div",et,[i[1]||(i[1]=e("div",{class:"pointer-events-none absolute left-[13px] top-3 bottom-3 w-[2px] bg-slate-200"},null,-1)),(l(!0),o(H,null,K(s(m),f=>(l(),o("div",{key:f.key,class:"relative flex gap-3 pb-4 last:pb-0"},[e("div",{class:y(["relative mt-1 flex h-7 w-7 items-center justify-center rounded-full border-2 bg-white",b(f.step)])},[e("img",{src:f.icon,alt:f.label,class:"h-4 w-4 object-contain"},null,8,tt),f.step<t.currentStep?(l(),o("div",st,[u(s(we),{class:"h-2.5 w-2.5 text-white"})])):C("",!0)],2),e("div",{class:y(["flex-1 rounded-2xl px-3 py-2.5 text-left",k(f.step)])},[f.step===t.currentStep?(l(),o("p",at," ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ")):C("",!0),e("p",nt,p(f.label),1),v(f.step)?(l(),o("p",lt,p(v(f.step)),1)):C("",!0),f.key==="on_the_way"&&t.status==="in_progress"&&t.currentStep>3?(l(),I(Ke,{key:2})):C("",!0)],2)]))),128))])]))}}),ot={class:"mt-1 mb-2 px-4"},rt={class:"flex items-center justify-between rounded-2xl bg-white px-3 py-2.5 shadow-sm"},dt={class:"flex items-center gap-2"},ct={class:"space-y-0.5"},ut={class:"text-[12px] font-semibold text-slate-900"},mt={key:0,class:"inline-flex items-center gap-1 text-[11px] text-emerald-600"},pt={key:1,class:"text-[11px] text-slate-400"},xt=R({__name:"TaskSummaryCard",props:{isFinalStep:{type:Boolean},title:{},description:{},isSummarySaved:{type:Boolean}},emits:["click"],setup(t){return(n,a)=>(l(),o("section",ot,[e("div",rt,[e("div",dt,[e("div",{class:y(["flex h-8 w-8 items-center justify-center rounded-full",t.isSummarySaved?"bg-emerald-50 text-emerald-600":"bg-slate-100 text-slate-500"])},[u(s(ae),{class:"h-4 w-4"})],2),e("div",ct,[e("p",ut,p(t.title),1),t.isFinalStep&&t.isSummarySaved?(l(),o("p",mt,[u(s(V),{class:"h-3.5 w-3.5"}),a[1]||(a[1]=j(" ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß (‡∏î‡∏π‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) ",-1))])):(l(),o("p",pt,p(t.description),1))])]),e("button",{type:"button",class:y(["rounded-full px-3 py-1.5 text-[11px] font-medium shadow-sm transition active:scale-95",t.isFinalStep?t.isSummarySaved?"bg-emerald-50 text-emerald-700":"bg-indigo-600 text-white":"bg-rose-500 text-white"]),onClick:a[0]||(a[0]=m=>n.$emit("click"))},p(t.isFinalStep?t.isSummarySaved?"‡∏î‡∏π‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô":"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô":t.title),3)])]))}}),ft={key:0,class:"px-4 mb-2 mt-1"},gt={class:"flex items-center justify-between rounded-2xl bg-white px-3 py-2.5 shadow-sm"},bt={class:"flex items-center gap-2"},ht={key:0,class:"text-xs text-emerald-600"},vt={key:1,class:"text-xs text-slate-400"},wt=["disabled"],yt=R({__name:"TaskSatisfactionCard",props:{canRateThisTask:{type:Boolean},hasRatedThisTask:{type:Boolean},averageRating:{},loading:{type:Boolean}},emits:["click"],setup(t){return(n,a)=>t.canRateThisTask?(l(),o("section",ft,[e("div",gt,[e("div",bt,[e("div",{class:y(["flex h-8 w-8 items-center justify-center rounded-full",t.hasRatedThisTask?"bg-emerald-50":"bg-amber-50"])},[u(s(ne),{class:y(["h-4 w-4",t.hasRatedThisTask?"text-emerald-500 fill-emerald-500":"text-amber-400"])},null,8,["class"])],2),e("div",null,[a[1]||(a[1]=e("p",{class:"text-[13px] font-semibold text-slate-900"},"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ",-1)),t.hasRatedThisTask&&t.averageRating?(l(),o("p",ht,p(t.averageRating??0)+"/5 ¬∑ 6 ‡∏Ç‡πâ‡∏≠ ",1)):(l(),o("p",vt,"‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô"))])]),e("button",{type:"button",class:y(["rounded-full px-3 py-1.5 text-xs font-medium shadow-sm",t.hasRatedThisTask?"bg-emerald-50 text-emerald-700":"bg-amber-500 text-white"]),disabled:t.loading,onClick:a[0]||(a[0]=m=>n.$emit("click"))},p(t.hasRatedThisTask?"‡∏î‡∏π‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô":"‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô"),11,wt)])])):C("",!0)}});function kt(t){const n=h(()=>s(t)),a=[{id:"overall",label:"‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°"},{id:"speed",label:"‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß"},{id:"quality",label:"‡∏ù‡∏µ‡∏°‡∏∑‡∏≠"},{id:"clean",label:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î"},{id:"polite",label:"‡∏°‡∏≤‡∏£‡∏¢‡∏≤‡∏ó"},{id:"explain",label:"‡∏Å‡∏≤‡∏£‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢"}],m=S([0,0,0,0,0,0]),b=S(!1),k=S(!1),r=S(!1),v=S({}),d=h(()=>n.value?.status==="done"),i=h(()=>{const x=n.value;return x&&v.value[x.id]||null}),f=h(()=>{const x=i.value;return!!x&&x.length===6}),B=h(()=>{const x=i.value;return!x||!x.length?null:(x.reduce((L,F)=>L+F,0)/x.length).toFixed(1)}),T=h(()=>m.value.every(x=>x>0));return{ratingItems:a,tempRatingScores:m,ratingModalOpen:b,ratingSuccessModalOpen:k,ratingLoading:r,canRateThisTask:d,currentRatingScores:i,hasRatedThisTask:f,averageRating:B,canSubmitRating:T,setTempScore:(x,_)=>{const L=[...m.value];L[x]=_,m.value=L},openRatingModal:()=>{const x=i.value;m.value=x?[...x]:[0,0,0,0,0,0],b.value=!0},closeRatingModal:()=>{r.value||(b.value=!1)},submitRating:async()=>{const x=n.value;if(x&&!(!T.value||f.value||r.value)){r.value=!0;try{await new Promise(_=>setTimeout(_,1500)),v.value[x.id]=[...m.value],b.value=!1,k.value=!0}catch(_){console.error("submitRating error:",_)}finally{r.value=!1}}}}}const St={class:"relative w-full rounded-t-[30px] bg-white px-4 pt-4 pb-6 shadow-lg"},$t={key:0,class:"mt-4 flex items-center justify-center"},Ct={class:"flex w-full max-w-[640px] max-h-[70vh] items-center justify-center overflow-hidden rounded-2xl bg-slate-900/5 px-2 py-2"},Tt=["src"],Mt=["src"],jt={key:1,class:"mt-6 flex min-h-[220px] flex-col items-center justify-center rounded-2xl border border-dashed border-rose-200 bg-rose-50/80 px-4 text-center"},Rt={class:"mb-3 flex h-11 w-11 items-center justify-center rounded-2xl bg-white shadow-sm"},_t=R({__name:"MediaPreview",props:{previewMedia:{}},emits:["close"],setup(t){return(n,a)=>(l(),o("div",St,[e("button",{type:"button",class:"absolute right-3 top-3 flex h-9 w-9 items-center justify-center rounded-full bg-black/70 text-white shadow-lg",onClick:a[0]||(a[0]=m=>n.$emit("close"))},[u(s(U),{class:"h-5 w-5"})]),t.previewMedia?(l(),o("div",$t,[e("div",Ct,[t.previewMedia.type==="image"?(l(),o("img",{key:0,src:t.previewMedia.url,alt:"‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô",class:"h-full max-h-[66vh] w-full max-w-full object-contain",onError:a[1]||(a[1]=m=>m.target.src="/images/no_Img.png")},null,40,Tt)):(l(),o("video",{key:1,src:t.previewMedia.url,controls:"",autoplay:"",class:"h-full max-h-[66vh] w-full max-w-full object-contain"},null,8,Mt))])])):(l(),o("div",jt,[e("div",Rt,[u(s(ke),{class:"h-6 w-6 text-rose-500"})]),a[4]||(a[4]=e("p",{class:"text-[13px] font-semibold text-rose-700"}," ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ",-1)),a[5]||(a[5]=e("p",{class:"mt-1 max-w-xs text-[11px] leading-relaxed text-rose-600"}," ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏à‡∏≤‡∏Å‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ",-1)),a[6]||(a[6]=e("p",{class:"mt-2 max-w-xs text-[10px] text-rose-500/80"},[j(" ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á"),e("br"),j(" ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤ "),e("span",{class:"font-mono"},"previewMedia"),j(" ‡∏°‡∏≤‡∏¢‡∏±‡∏á‡∏Ñ‡∏≠‡∏°‡πÇ‡∏û‡πÄ‡∏ô‡∏ô‡∏ï‡πå‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ üòâ ")],-1)),e("button",{type:"button",class:"mt-3 inline-flex items-center gap-1 rounded-full border border-rose-200 bg-white px-3 py-1.5 text-[11px] font-medium text-rose-600 shadow-sm",onClick:a[2]||(a[2]=m=>n.$emit("close"))},[u(s(U),{class:"h-3.5 w-3.5"}),a[3]||(a[3]=e("span",null,"‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ",-1))])]))]))}}),At={class:"relative w-full rounded-t-3xl bg-white px-5 pt-4 pb-5 shadow-lg"},Lt={class:"px-6 pb-4 text-center"},It={class:"mt-2 text-base font-semibold text-emerald-600"},Bt={class:"px-1 py-4"},Dt={class:"rounded-xl bg-slate-50 border border-slate-200 p-4 text-sm text-slate-700 space-y-2"},Ft={class:"flex items-start gap-2"},Pt={key:0,class:"flex items-start gap-2"},zt={class:"flex items-start gap-2"},Et={key:1,class:"flex items-start gap-2"},Nt={key:2,class:"flex items-start gap-2"},Ot={class:"flex gap-2"},Ut=R({__name:"ConfirmStatusUpdateModal",props:{jobNo:{},room:{},statusLabel:{},assignee:{},updatedAt:{},questionText:{},isStatus:{type:Boolean}},emits:["confirm","cancel"],setup(t,{emit:n}){const a=n,m=()=>{a("cancel")},b=()=>{a("confirm")};return(k,r)=>(l(),o("div",At,[e("div",Lt,[e("div",{class:y(["mx-auto mb-1 flex h-12 w-12 items-center justify-center rounded-full",t.isStatus?"text-indigo-700":"text-rose-600"])},[u(s(ge),{class:"w-6 h-6"})],2),e("h2",{class:y(["text-lg font-semibold",t.isStatus?"text-indigo-800":"text-rose-700"])},p(t.isStatus?"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô":"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"),3),e("p",It,p(t.questionText),1)]),e("div",Bt,[e("div",Dt,[e("p",Ft,[u(s(be),{class:y(["w-4 h-4 mt-0.5",t.isStatus?"text-indigo-600":"text-rose-500"])},null,8,["class"]),e("span",null,[r[0]||(r[0]=e("span",{class:"font-medium text-slate-900"},"‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏á‡∏≤‡∏ô:",-1)),j(" "+p(t.jobNo),1)])]),t.room?(l(),o("p",Pt,[u(s(xe),{class:y(["w-4 h-4 mt-0.5",t.isStatus?"text-indigo-600":"text-rose-500"])},null,8,["class"]),e("span",null,[r[1]||(r[1]=e("span",{class:"font-medium text-slate-900"},"‡∏´‡πâ‡∏≠‡∏á:",-1)),j(" "+p(t.room),1)])])):C("",!0),e("p",zt,[u(s(V),{class:"w-4 h-4 mt-0.5 text-emerald-500"}),e("span",null,[r[2]||(r[2]=e("span",{class:"font-medium text-slate-900"}," ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å: ",-1)),j(" "+p(t.statusLabel),1)])]),t.assignee?(l(),o("p",Et,[u(s(he),{class:y(["w-4 h-4 mt-0.5",t.isStatus?"text-indigo-600":"text-rose-500"])},null,8,["class"]),e("span",null,[r[3]||(r[3]=e("span",{class:"font-medium text-slate-900"},"‡∏ú‡∏π‡πâ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:",-1)),j(" "+p(t.assignee),1)])])):C("",!0),t.updatedAt?(l(),o("p",Nt,[u(s(ye),{class:y(["w-4 h-4 mt-0.5",t.isStatus?"text-indigo-600":"text-rose-500"])},null,8,["class"]),e("span",null,[r[4]||(r[4]=e("span",{class:"font-medium text-slate-900"},"‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï:",-1)),j(" "+p(t.updatedAt),1)])])):C("",!0)])]),e("div",Ot,[e("button",{type:"button",class:"min-h-[44px] flex-1 rounded-full border border-slate-300 bg-white px-3 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-50 disabled:cursor-not-allowed disabled:opacity-40",onClick:m}," ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å "),e("button",{type:"button",class:y(["min-h-[44px] flex-1 rounded-full px-3 py-2 text-sm font-semibold text-white shadow-sm active:scale-95 disabled:cursor-not-allowed disabled:bg-slate-300 flex items-center justify-center gap-1.5",t.isStatus?"bg-indigo-600 hover:bg-indigo-700":"bg-rose-500 hover:bg-rose-600"]),onClick:b},[u(s(fe),{class:"h-4 w-4"}),e("span",null,p(t.isStatus?"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô":"‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"),1)],2)])]))}}),Vt=re(Ut,[["__scopeId","data-v-eeaf67be"]]),Ht={key:0,class:"min-h-screen bg-slate-50 pb-6"},qt={class:"flex items-center gap-3"},Gt={class:"px-2.5 py-0.5 text-xs font-medium text-slate-600"},Jt={class:"bg-slate-50/80 backdrop-blur"},Qt={class:"mt-1 space-y-4 px-4"},Kt={key:1,class:"px-4 mt-4"},os=R({__name:"index",props:{task:{}},setup(t){const n=t,{ratingLoading:a,canRateThisTask:m,hasRatedThisTask:b,averageRating:k,openRatingModal:r}=kt(n.task),v=de(),d=ce(),{isMobile:i}=ue(d),{headerRef:f,showStickyHeader:B}=le(i),T=S(!1),g=Q({userCode:"",jobNo:"",typeCode:"",typeSeq:""}),c=Q({assignee:"",nextStatusLabel:"",currentTimeText:"",isStatus:!1}),$=S(!1),M=S(null),x=A=>{M.value=A,$.value=!0},_=h(()=>d.user?.userType==="e"),L=h(()=>_.value&&G.value?.empCode==d.user?.userCode),F=()=>v.back(),W=h(()=>!!n.task?.isSubmit),P=h(()=>n.task?.currentStep===5),G=h(()=>n.task?n.task.timeline?.find(A=>A.step===n.task?.currentStep)??null:null),X=h(()=>P.value?"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô":"‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"),Y=h(()=>G.value?.label??""),Z=()=>{if(!n.task)return;const A=n.task.timeline?.find(w=>w.step===n.task?.currentStep);Object.assign(g,{jobNo:n.task.id,typeCode:A?.code,typeSeq:A?.step}),console.log(JSON.stringify(g,null,2)),c.assignee=d.user?.name??"",c.nextStatusLabel=A?.label??"",c.currentTimeText=new Date().toLocaleString("th-TH",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),c.isStatus=!!P.value,T.value=!0};return(A,w)=>t.task?(l(),o("div",Ht,[e("div",{class:y(["flex items-center justify-between px-4 pt-3 pb-2",[s(i)?"sticky -top-3 z-30":"",s(B)?"bg-slate-50/90 backdrop-blur supports-[backdrop-filter]:bg-slate-50/70 border-b border-slate-200/70 shadow-sm rounded-b-2xl":""]])},[e("div",qt,[e("button",{type:"button",class:"flex h-10 w-10 items-center justify-center rounded-full bg-white shadow-sm transition active:scale-95 touch-manipulation",onClick:F},[u(s(ve),{class:"h-4 w-4 text-slate-700"})]),w[5]||(w[5]=e("span",{class:"text-base font-semibold text-slate-900"}," ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô ",-1))]),e("span",Gt,p(t.task.id),1)],2),e("header",Jt,[e("div",{ref_key:"headerRef",ref:f},null,512),u(_e,{task:t.task},null,8,["task"])]),(t.task.id||t.task.timeline?.length&&t.task.timeline?.length>0)&&s(L)?(l(),I(xt,{key:0,isFinalStep:s(P),title:s(X),description:s(Y),isSummarySaved:s(W),onClick:Z},null,8,["isFinalStep","title","description","isSummarySaved"])):C("",!0),u(yt,{"can-rate-this-task":s(m),"has-rated-this-task":s(b),"average-rating":s(k),loading:s(a),onClick:s(r)},null,8,["can-rate-this-task","has-rated-this-task","average-rating","loading","onClick"]),e("main",Qt,[t.task.media&&t.task.media.length?(l(),I(Ne,{key:0,media:t.task.media,onPreview:x},null,8,["media"])):C("",!0),t.task.id?(l(),I(it,{key:2,status:t.task.status,currentStep:t.task.currentStep??0,timeline:t.task.timeline??[]},null,8,["status","currentStep","timeline"])):(l(),o("section",Kt,[...w[6]||(w[6]=[me('<div class="rounded-3xl bg-emerald-500 px-4 py-3 shadow-md flex items-center justify-between"><div class="flex items-center gap-2"><img src="https://img.icons8.com/color/48/hourglass-sand-top.png" alt="‡∏£‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á" class="w-5 h-5 shrink-0"><div class="flex flex-col"><span class="text-xs text-emerald-100">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏á‡∏≤‡∏ô</span><span class="text-sm font-semibold text-white leading-snug"> ‡∏£‡∏≠‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏á‡∏≤‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô </span></div></div><span class="inline-flex items-center rounded-full bg-white/15 px-3 py-1 text-xs font-medium text-white"> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô </span></div>',1)])]))]),u(O,{"model-value":s($),"onUpdate:modelValue":w[1]||(w[1]=D=>$.value=!1)},{default:N(()=>[u(_t,{previewMedia:s(M),onClose:w[0]||(w[0]=D=>$.value=!1)},null,8,["previewMedia"])]),_:1},8,["model-value"]),u(O,{"model-value":s(T),"onUpdate:modelValue":w[4]||(w[4]=D=>T.value=!1)},{default:N(()=>[u(Vt,{"job-no":t.task.id,room:t.task.room,"status-label":s(c).nextStatusLabel,assignee:s(c).assignee,"updated-at":s(c).currentTimeText,isStatus:s(c).isStatus,onCancel:w[2]||(w[2]=D=>T.value=!1),onConfirm:w[3]||(w[3]=D=>T.value=!1)},null,8,["job-no","room","status-label","assignee","updated-at","isStatus"])]),_:1},8,["model-value"])])):C("",!0)}});export{os as _};
